![](../images/Pasted%20image%2020251016185559.png)

TCP / IP 에서는 4개의 주소 단계를 사용하는데, 각 TCP/IP model의 각 계층과 연관있다.

가장 위의 **응용 계층(Application Layer)** 에서는 데이터가 **메시지(Message)** 형태로 전송된다. 예를 들어 HTTP 요청이나 이메일 메시지 등이 여기에 해당하며, 이때 사용하는 주소는 **Application-Specific Address**, 즉 응용 프로그램에 특화된 주소이다. 이는 실제 네트워크 주소가 아니라, 예를 들어 URL이나 도메인 이름처럼 응용 단계에서 데이터를 구분하기 위한 논리적 식별자에 가깝다.

그다음 **전송 계층(Transport Layer)** 에서는 데이터가 **세그먼트(Segment)** 단위로 전송된다. TCP나 UDP 같은 프로토콜이 동작하며, 각 응용 프로그램을 구분하기 위해 **포트 주소(Port Address)** 를 사용한다. 예를 들어, 웹 서비스는 포트 80(HTTP)이나 443(HTTPS)을 사용한다.

**네트워크 계층(Network Layer)** 로 내려오면 데이터는 **데이터그램(Datagram)** 단위로 처리된다. 이 계층에서 사용하는 주소는 **논리적 주소(Logical Address)** 로, 바로 우리가 흔히 말하는 **IP 주소**다. 이 IP 주소를 기반으로 출발지에서 목적지까지 경로가 결정되고, 라우터를 거치며 전달된다.

그 아래의 **데이터 링크 계층(Data Link Layer)** 에서는 데이터가 **프레임(Frame)** 형태로 전송된다. 이 계층에서는 실제 물리적 장치 간의 통신이 이루어지므로 **물리적 주소(Physical Address)**, 즉 **MAC 주소**가 사용된다. MAC 주소는 네트워크 카드(NIC)에 고유하게 부여된 하드웨어 식별자다.

![](../images/Pasted%20image%2020251016190514.png)

마지막으로 **물리 계층(Physical Layer)** 에서는 프레임이 전기적·광학적 신호로 변환되어 **비트 단위(Bits)** 로 전송된다. 이 단계에서는 주소 개념이 존재하지 않고, 단순히 0과 1의 신호가 매체를 따라 전달된다.

---

![](../images/Pasted%20image%2020251016190716.png)

LAN(Local Area Network) 내에서 사용하는 주소는 **MAC 주소(Media Access Control Address)** 라고 부른다. 이 주소는 네트워크 카드(NIC, Network Interface Card)에 고유하게 부여되는 물리적 주소로, **데이터 링크 계층(2계층)** 에서 통신할 때 사용된다.

MAC 주소는 **총 48비트(6바이트)** 로 구성되어 있으며, 이를 사람이 읽기 쉽게 표현할 때는 **16진수(Hexadecimal)** 형태로 나타낸다. 즉, 각 바이트(8비트)는 16진수 두 자리로 표시되고, 총 6개의 블록으로 이루어진다.

---
### Logical Address


![](../images/Pasted%20image%2020251016191259.png)

A라는 IP 주소를 가진 송신자(Sender)가 P라는 IP 주소를 가진 수신자(Receiver)에게 데이터를 전송하려고 한다고 하자. 이때 송신자는 먼저 자신의 **라우팅 테이블(Routing Table)** 을 확인한다. 라우팅 테이블에는 “특정 목적지 IP로 가려면 다음에 어디로 보내야 하는지(next hop)” 정보가 들어 있다. 송신자는 이를 통해 최종 목적지 P로 가기 위해 **다음으로 향해야 할 IP 주소**를 알아낸다.

이제 송신자는 **ARP(Address Resolution Protocol) 테이블**을 확인한다. 이 테이블은 IP 주소와 MAC 주소의 대응 관계를 저장하고 있다. 송신자는 방금 찾은 다음 목적지의 IP 주소에 대응하는 **MAC 주소**를 알아내어, IP 패킷 앞에 이 MAC 주소를 붙여 **프레임(Frame)** 을 만든다.

이렇게 만들어진 프레임은 같은 LAN(Local Area Network) 내에서 MAC 주소를 기반으로 전송된다. 만약 해당 MAC 주소가 최종 목적지의 것이 아니라 **라우터의 MAC 주소**라면, 이 프레임은 우선 라우터로 전달된다. 송신 측 LAN에서는 라우터가 “다음 목적지” 역할을 하는 것이다.

라우터에 도착하면, 라우터는 프레임의 **데이터 링크 계층 헤더(즉, MAC 주소 부분)** 를 제거하고, IP 패킷을 확인한다. 그 다음 라우터는 자신의 **라우팅 테이블**을 다시 조회하여 최종 목적지 P로 가기 위해 다음으로 향해야 할 경로를 찾는다. 그리고 **ARP 테이블**을 통해 그 다음 목적지의 MAC 주소를 알아낸 뒤, 새로운 프레임을 만들어 다시 전송한다.

이 과정은 패킷이 여러 개의 네트워크(LAN)를 거치는 동안 계속 반복된다. 즉, 매 구간(hop)마다 라우터는 **라우팅 테이블 → ARP 테이블 → 프레임 생성 → 전송** 과정을 수행하며, MAC 주소는 각 LAN 구간에서만 유효하다.

마지막으로, 패킷이 최종 목적지 P와 같은 LAN에 도착하면, 라우터는 P의 MAC 주소를 ARP 테이블에서 확인한 뒤 그 주소를 프레임에 넣어 보낸다. 이제 이 프레임은 최종 목적지의 네트워크 카드에 도달하고, IP 패킷이 상위 계층으로 전달되면서 전송이 완료된다.


### 라우터로 들어가는 IP 주소와 나가는 IP 주소가 다르다?

그림을 보면, 라우터로 들어갈 때 사용되는 IP 주소와 나갈 때 사용되는 IP 주소가 서로 다르다는 것을 알 수 있다. 이는 라우터가 여러 개의 **인터페이스(interface)** 를 가지고 있으며, 각각의 인터페이스가 서로 다른 **네트워크(LAN)** 에 연결되어 있기 때문이다.

각 인터페이스는 자신이 속한 네트워크 내에서만 유효한 **고유한 IP 주소**와 **MAC 주소**를 가진다.  
따라서 송신자는 **F/20**이라는 정보를 이용해, 즉 **IP 주소 F에 해당하는 MAC 주소 20**을 목적지로 하여 데이터를 전송한다. 이렇게 라우터의 한쪽 인터페이스로 들어온 데이터는 라우터 내부에서 라우팅 과정을 거친 뒤, 다른 네트워크로 나가기 위해 **T라는 IP 주소와 MAC 주소 99**를 사용하는 **다른 인터페이스**를 통해 전송된다.

---

## Port numbers
자 다음은 port numbers 에 대해 알아볼텐데 이와 연관된 계층은 transport 계층이다. 

process to process 방식을 사용하기 때문에 해당 프로세스에 접근하기 위해 포트 번호를 설정하는 것이다. 
![](../images/Pasted%20image%2020251016194211.png)

일단 클라이언트에서 보낼 때는 자신의 포트 번호는 몰라도 된다. 왜냐면 자동으로 정해주기 때문이다. 단 상대방의 포트번호는 알아야한다. 근데 상대방의 포트 번호는 어떻게 알까?
사실 포트 번호는 0~1023번까지는 정해진 사용 범위가 있다. 예를 들어서 application layer에서 message 형식이 http 메세지라고 하자. 그러면 application에서 transport로 내려올 때 지금 전달하는 message는 http 메세지다! 라고 알려주면 http 메세지는 80포트를 사용한다고 약속을 해