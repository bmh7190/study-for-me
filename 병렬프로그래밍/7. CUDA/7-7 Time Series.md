여기서는 시계열(time series) 데이터를 예시로 활용해보려고 한다. 시계열 데이터란 말 그대로 시간의 흐름에 따라 변화하는 값을 기록한 데이터로, 음성 신호, 센서 기록, 주가, 생체신호 등 다양한 분야에서 등장한다. 우리는 여러 개의 시계열 데이터가 주어졌을 때, **서로 얼마나 유사한지 비교해야 하는 상황**을 가정해볼 것이다.


![](../../images/Pasted%20image%2020251204151653.png)
예를 들어 위 그림은 “exact”라는 단어를 미국인과 영국인이 발음한 음성 파형을 각각 시계열로 나타낸 것이다. 두 사람은 같은 단어를 발음했기 때문에 전체적인 파형의 모양은 비슷하다. 지금까지 이미지에서는 단순히 유클리디안 거리(Euclidean distance)를 이용해 두 데이터가 비슷한지 판별할 수 있었다. 이미지의 경우 각 픽셀이 고정된 위치를 갖고 있기 때문에 같은 위치의 값을 비교하면 의미가 있기 때문이다.

하지만 시계열 데이터는 상황이 다르다. 같은 파형이라도 **언제 피크가 발생했는지**, 즉 **시간이 얼마나 빨리 혹은 늦게 흐르는지**에 따라 모양이 어긋날 수 있다. 예를 들어 두 사람이 같은 단어를 말하더라도 한 사람은 조금 더 천천히 말하고, 다른 사람은 더 빠르게 말할 수 있다. 이럴 때 단순히 같은 시점(time index)의 값을 빼서 거리를 계산해버리면, 실제로는 유사한 두 신호가 서로 다르게 보일 수 있다.

## Dynamic Time Warping (DTW)
그래서 이번에는 이러한 시간 차이를 보정해가며 유사도를 계산할 수 있는 방법, 즉 **Dynamic Time Warping(DTW)** 을 적용해볼 것이다. 쉽게 말하면, DTW는 두 시계열의 특정 시점들이 꼭 일대일로 대응하지 않더라도, **시간 축을 자유롭게 늘였다 줄였다 하면서 가장 잘 맞는 정렬(alignment)을 찾아주는 방법**이다. 다시 말해, “이 두 시계열이 서로 얼마나 비슷하게 생겼는가?”를 **시간의 왜곡을 허용한 상태에서 계산**할 수 있게 해주는 알고리즘이다.

DTW를 이해하기 위해서는 먼저, 두 시계열을 어떻게 “정렬”하는지를 그래프로 표현한 DAG(Directed Acyclic Graph) 구조를 살펴볼 필요가 있다. 아래 그림은 길이가 각각 4인 두 시계열에 대해 DTW 거리 계산 과정에서 등장하는 DAG의 한 예시이다. 이 그래프의 각 노드는 두 시계열의 특정 시점 조합 $(i,j)$을 나타내며, DTW는 이 노드들을 연결하는 경로 중 비용이 최소가 되는 경로를 찾는 과정이라고 볼 수 있다.

![](../../images/Pasted%20image%2020251204152921.png)


이 그래프에는 다음과 같은 핵심 제약 조건들이 존재한다.

1. **Continuity(연속성)**  
    노드 간 이동은 항상 한 칸씩만 가능하며, 이동 방향은 가로, 세로, 대각선의 세 가지뿐이다.  
    즉, $(i, j) \rightarrow (i+1, j), (i, j+1), (i+1, j+1)$ 형태로만 이동할 수 있다.  
    이를 통해 warping path가 불연속적으로 점프하지 않도록 제한한다.
    
2. **Monotony(단조성)**  
    이동할 때마다 적어도 하나의 인덱스가 증가해야 한다.즉, 시간축을 거꾸로 되돌아가거나 감소하는 방향으로 움직일 수 없다. 이는 시계열의 시간 흐름을 보존한다는 뜻이다.
    
3. **Bounding(경계 조건)**  
    최적의 warping path는 **왼쪽 위(0,0)** 에서 시작하여 **오른쪽 아래(n−1, m−1)** 에서 끝나야 한다. 다시 말해, 두 시계열의 처음과 끝이 반드시 서로 매칭되어야 한다.
    

이 세 가지 조건이 만족되는 경로들 중에서, 각 노드에서의 시계열 간 “거리”(예: |x[i] − y[j]|)를 누적했을 때 총 비용이 가장 작은 경로가 바로 **DTW가 말하는 최적 warping path**이다.  

그 경로 위의 노드들이 두 시계열이 시간 왜곡을 허용한 상태에서 어떻게 서로 “최적으로 정렬되는지”를 보여준다.

---
![](../../images/Pasted%20image%2020251204153822.png)

수식으로 보면 가장 먼저 모든 포인트에 대해서 비교를 한다. 이걸 weighing function 을 하는 단계라고 보면 된다. 이때는 그냥 해당 포인트의 빼고 제곱하는 느낌으로...